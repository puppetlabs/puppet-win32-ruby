<?xml version="1.0" encoding="IBM437"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=IBM437" http-equiv="Content-Type" />

  <title>Class: Windows::API</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/windows/api_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/windows/api.rb">lib/windows/api.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="../Object.html">Object</a></p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-auto_constant">::auto_constant</a></li>
          
          <li><a href="#method-c-auto_constant-3D">::auto_constant=</a></li>
          
          <li><a href="#method-c-auto_method">::auto_method</a></li>
          
          <li><a href="#method-c-auto_method-3D">::auto_method=</a></li>
          
          <li><a href="#method-c-auto_namespace">::auto_namespace</a></li>
          
          <li><a href="#method-c-auto_namespace-3D">::auto_namespace=</a></li>
          
          <li><a href="#method-c-auto_unicode">::auto_unicode</a></li>
          
          <li><a href="#method-c-auto_unicode-3D">::auto_unicode=</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-call">#call</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../CHANGES.html">CHANGES</a></li>
        
          <li class="file"><a href="../MANIFEST.html">MANIFEST</a></li>
        
          <li class="file"><a href="../README.html">README</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Windows.html">Windows</a></li>
        
          <li><a href="../Windows/API.html">Windows::API</a></li>
        
          <li><a href="../Object.html">Object</a></li>
        
          <li><a href="../WideString.html">WideString</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Windows::API</h1>

    <div id="description" class="description">
      
<p>Wrapper around the Win32::API class</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="DATA_TYPES">DATA_TYPES</a></dt>
          
          <dd class="description"><p>Verbose data types that can be used instead of single letters</p></dd>
          
        
          <dt><a name="VERSION">VERSION</a></dt>
          
          <dd class="description"><p>The version of the windows-api library</p></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="auto_constant-method" class="method-detail ">
          <a name="method-c-auto_constant"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_constant</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the value of the @<a
href="API.html#method-c-auto_constant">auto_constant</a> class instance
variable. The default is nil, i.e. none. See the <a
href="API.html#method-c-auto_constant-3D">Windows::API.auto_constant=</a>
documentation for more information.</p>
            

            
            <div class="method-source-code" id="auto_constant-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_constant</span>
  <span class="ruby-ivar">@auto_constant</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_constant-source -->
            
          </div>

          

          
        </div><!-- auto_constant-method -->

      
        <div id="auto_constant-3D-method" class="method-detail ">
          <a name="method-c-auto_constant-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_constant=</span><span
              class="method-args">(bool)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Automatically sets a constant to match the function name.</p>

<p>The standard practice for defining <a href="API.html">Windows::API</a>
objects is to use a constant that matches the function name. For example,
this is a typical idiom:</p>

<pre>module Windows
   module File
      GetFileAttributes = API.new('GetFileAttributes', 'P','L')
   end
end</pre>

<p>With the <a href="API.html#method-c-auto_constant">API.auto_constant</a>
value set to true you can avoid the assignment step and the matching
constant name will be automatically set for you in the namespace defined in
<a href="API.html#method-c-auto_namespace">API.auto_namespace</a>. In other
words, this example is identical to the one above:</p>

<pre>module Windows
   module File
      API.auto_constant  = true
      API.auto_namespace = 'Windows::File'
      API.new('GetFileAttributes', 'P', 'L')
   end
end</pre>

<p>If the <a href="API.html#method-c-auto_constant">auto_constant</a> class
variable is set to true, but no <a
href="API.html#method-c-auto_namespace">auto_namespace</a> is set, an error
will be raised. Note that the namespace must refer to an existing module
(not a class).</p>
            

            
            <div class="method-source-code" id="auto_constant-3D-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 167</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_constant=</span>(<span class="ruby-identifier">bool</span>)
  <span class="ruby-ivar">@auto_constant</span> = <span class="ruby-identifier">bool</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_constant-3D-source -->
            
          </div>

          

          
        </div><!-- auto_constant-3D-method -->

      
        <div id="auto_method-method" class="method-detail ">
          <a name="method-c-auto_method"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_method</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the value of the <a
href="API.html#method-c-auto_method">auto_method</a> class instance
variable. Used in conjunction with auto_unicode.  See <a
href="API.html#method-c-auto_method-3D">API.auto_method=</a> for more
information.</p>
            

            
            <div class="method-source-code" id="auto_method-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 194</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_method</span>
  <span class="ruby-ivar">@auto_method</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_method-source -->
            
          </div>

          

          
        </div><!-- auto_method-method -->

      
        <div id="auto_method-3D-method" class="method-detail ">
          <a name="method-c-auto_method-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_method=</span><span
              class="method-args">(bool)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>If this option is set to true then a corresponding method is automatically
generated when you create a new <a href="API.html">Windows::API</a> object.</p>

<p>For example, instead of doing this:</p>

<pre>module Windows
   module File
      GetFileAttributes = API.new('GetFileAttributes', 'P', 'L')

      def GetFileAttributes(x)
         GetFileAttributes.call(x)
      end
   end
end</pre>

<p>You can do this, and have the method autogenerated for you.</p>

<pre>module Windows
   module File
      API.auto_namespace = 'Windows::File'
      API.auto_constant  = true
      API.auto_method    = true
      API.new('GetFileAttributes', 'P', 'L')
   end
end

include Windows::File
GetFileAttributes('C:/test.txt') # vs. GetFileAttributes.call</pre>

<p>If the <a href="API.html">Windows::API</a> object is declared to be a
boolean in the constructor, then the method definition automatically
includes a '!= 0' clause at the end of the call. That way, you can do 'if
SomeMethod(x)' instead of having to do 'if SomeMethod(x) != 0', and it will
do the right thing.</p>

<p>If the <a href="API.html#method-c-auto_unicode">API.auto_unicode</a> option
is also set to true, then you will get three method definitions. The
standard function name, the explicit ANSI ('A') version and the explicit
Unicode/wide version ('W'). The exception to this rule is that the explicit
ANSI and Unicode methods will NOT be generated if the function passed to
the constructor already ends with 'A' or 'W'.</p>
            

            
            <div class="method-source-code" id="auto_method-3D-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_method=</span>(<span class="ruby-identifier">bool</span>)
  <span class="ruby-ivar">@auto_method</span> = <span class="ruby-identifier">bool</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_method-3D-source -->
            
          </div>

          

          
        </div><!-- auto_method-3D-method -->

      
        <div id="auto_namespace-method" class="method-detail ">
          <a name="method-c-auto_namespace"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_namespace</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the value of the <a
href="API.html#method-c-auto_namespace">auto_namespace</a> class instance
variable. Used in conjunction with <a
href="API.html#method-c-auto_constant">API.auto_constant</a> and/or <a
href="API.html#method-c-auto_method">API.auto_method</a>.</p>
            

            
            <div class="method-source-code" id="auto_namespace-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 174</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_namespace</span>
  <span class="ruby-ivar">@auto_namespace</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_namespace-source -->
            
          </div>

          

          
        </div><!-- auto_namespace-method -->

      
        <div id="auto_namespace-3D-method" class="method-detail ">
          <a name="method-c-auto_namespace-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_namespace=</span><span
              class="method-args">(namespace)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the value of the <a
href="API.html#method-c-auto_namespace">auto_namespace</a> class nstance
variable. The default is nil, i.e. none. Use in conjunction with the <a
href="API.html#method-c-auto_constant">auto_constant</a> and/or <a
href="API.html#method-c-auto_method">auto_method</a> class variables, this
method will automatically set a constant and/or method in
<tt>namespace</tt> equal to the function name set in the constructor.</p>

<p>The <tt>namespace</tt> must refer to an existing module, not a class.</p>
            

            
            <div class="method-source-code" id="auto_namespace-3D-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_namespace=</span>(<span class="ruby-identifier">namespace</span>)
  <span class="ruby-ivar">@auto_namespace</span> = <span class="ruby-identifier">namespace</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_namespace-3D-source -->
            
          </div>

          

          
        </div><!-- auto_namespace-3D-method -->

      
        <div id="auto_unicode-method" class="method-detail ">
          <a name="method-c-auto_unicode"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_unicode</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the value of the <a
href="API.html#method-c-auto_unicode">auto_unicode</a> class instance
variable. This is used in conjunction with the <a
href="API.html#method-c-auto_method">auto_method</a> and/or <a
href="API.html#method-c-auto_constant">auto_constant</a> class variables.
Not significant if neither of those variables are set.</p>
            

            
            <div class="method-source-code" id="auto_unicode-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 248</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_unicode</span>
  <span class="ruby-ivar">@auto_unicode</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_unicode-source -->
            
          </div>

          

          
        </div><!-- auto_unicode-method -->

      
        <div id="auto_unicode-3D-method" class="method-detail ">
          <a name="method-c-auto_unicode-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">auto_unicode=</span><span
              class="method-args">(bool)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>If set to true, and the <a
href="API.html#method-c-auto_constant">auto_constant</a> variable is set,
then the automatic constant generation will generate the explicit ANSI
('A') and Unicode/wide ('W') versions of the function passed to the
constructor, if such versions exist.  Likewise, if the the <a
href="API.html#method-c-auto_method">auto_method</a> variable is set, then
explicit ANSI and Unicode methods are generated.</p>

<p>Here's a typical idiom:</p>

<p>module <a href="../Windows.html">Windows</a></p>

<pre>module Path
   API.auto_namespace = Windows::Path
   API.auto_constant = true
   API.new('shlwapi', 'PathAddBackslash', 'P', 'P')
   API.new('shlwapi', 'PathAddBackslashA', 'P', 'P')
   API.new('shlwapi', 'PathAddBackslashW', 'P', 'P')
end</pre>

<p>end</p>

<p>That can be reduced to this:</p>

<p>module <a href="../Windows.html">Windows</a></p>

<pre>module Path
   API.auto_namespace = Windows::Path
   API.auto_constant = true
   API.auto_unicode  = true
   API.new('shlwapi', 'PathAddBackslash', 'P', 'P')
end</pre>

<p>end</p>

<p>This value is ignored if the function passed to the constructor already
ends with an 'A' or 'W'.</p>
            

            
            <div class="method-source-code" id="auto_unicode-3D-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 285</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">auto_unicode=</span>(<span class="ruby-identifier">bool</span>)
  <span class="ruby-ivar">@auto_unicode</span> = <span class="ruby-identifier">bool</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- auto_unicode-3D-source -->
            
          </div>

          

          
        </div><!-- auto_unicode-3D-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">new(func, proto='V', rtype='L', dll='kernel32')</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Creates and returns a new <a href="API.html">Windows::API</a> object.  The
<tt>func</tt> is the name of the <a href="../Windows.html">Windows</a>
function.</p>

<p>The <tt>proto</tt> is the function prototype for <tt>func</tt>.  This can
be a string or an array of characters.  The possible valid characters are
'I' (integer), 'B' (BOOL), 'L' (long), 'V' (void), or 'P' (pointer). The
default is void ('V').</p>

<p>The <tt>rtype</tt> argument is the return type for the function.  The valid
characters are the same as for the <tt>proto</tt>. The default is long
('L').</p>

<p>The 'B' (BOOL) return type is the same as 'I' (Integer). This is
significant only if the <a
href="API.html#method-c-auto_method">API.auto_method</a> option is set to
true, in which case it alters the generated method definition slightly. See
the <a href="API.html#method-c-auto_method-3D">API.auto_method=</a> class
method for more information.</p>

<p>The <tt>dll</tt> is the name of the DLL file that the function is exported
from. The default is 'kernel32'.</p>

<p>If the function cannot be found then an API::Error is raised (a subclass of
RuntimeError).</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 314</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">proto</span>=<span class="ruby-string">'V'</span>, <span class="ruby-identifier">rtype</span>=<span class="ruby-string">'L'</span>, <span class="ruby-identifier">dll</span>=<span class="ruby-string">'kernel32'</span>)
  <span class="ruby-comment"># Convert literal data types to values that win32-api understands</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">proto</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">proto</span>.<span class="ruby-identifier">each_with_index</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">pt</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">pt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
        <span class="ruby-identifier">proto</span>[<span class="ruby-identifier">index</span>].<span class="ruby-identifier">replace</span>(<span class="ruby-constant">DATA_TYPES</span>[<span class="ruby-identifier">pt</span>])
      <span class="ruby-keyword">end</span>
    }
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rtype</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">rtype</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-constant">DATA_TYPES</span>[<span class="ruby-identifier">rtype</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@function_name</span> = <span class="ruby-identifier">func</span>
  <span class="ruby-ivar">@prototype</span>     = <span class="ruby-identifier">proto</span>
  <span class="ruby-ivar">@return_type</span>   = <span class="ruby-identifier">rtype</span> <span class="ruby-operator">==</span> <span class="ruby-string">'B'</span> <span class="ruby-operator">?</span> <span class="ruby-string">'I'</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">rtype</span>
  <span class="ruby-ivar">@dll_name</span>      = <span class="ruby-identifier">dll</span>
  <span class="ruby-ivar">@boolean</span>       = <span class="ruby-identifier">rtype</span> <span class="ruby-operator">==</span> <span class="ruby-string">'B'</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>

  <span class="ruby-ivar">@api</span> = <span class="ruby-constant">Win32</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">proto</span>, <span class="ruby-identifier">rtype</span>, <span class="ruby-identifier">dll</span>)

  <span class="ruby-identifier">api_a</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">api_w</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># If the auto_unicode option is set, and the func is not already</span>
  <span class="ruby-comment"># an explicit ANSI or Wide function name, generate Win32::API</span>
  <span class="ruby-comment"># objects for those functions as well. Ignore errors because not</span>
  <span class="ruby-comment"># all functions have explicit ANSI or Wide character implementations.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># This entire bit of logic is skipped if the DLL is msvcrt, since</span>
  <span class="ruby-comment"># msvcrt functions never have explicit ANSI or Wide character</span>
  <span class="ruby-comment"># versions.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_unicode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">dll</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/msvcr/</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">unless</span> [<span class="ruby-string">'A'</span>, <span class="ruby-string">'W'</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">func</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">chr</span>)
        <span class="ruby-identifier">api_a</span> = <span class="ruby-constant">Win32</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{func}A&quot;</span>, <span class="ruby-identifier">proto</span>, <span class="ruby-identifier">rtype</span>, <span class="ruby-identifier">dll</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">RuntimeError</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">unless</span> [<span class="ruby-string">'W'</span>, <span class="ruby-string">'A'</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">func</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">chr</span>)
        <span class="ruby-identifier">api_w</span> = <span class="ruby-constant">Win32</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{func}W&quot;</span>, <span class="ruby-identifier">proto</span>, <span class="ruby-identifier">rtype</span>, <span class="ruby-identifier">dll</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">RuntimeError</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">func_upper</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Automatically define a constant matching the function name if the</span>
  <span class="ruby-comment"># auto_constant option is set. Lower case method names will have a</span>
  <span class="ruby-comment"># capitalized equivalent created, e.g. Memcpy for memcpy, etc.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_constant</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_namespace</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_namespace</span> <span class="ruby-operator">!=</span> <span class="ruby-string">'Windows'</span>
      <span class="ruby-identifier">namespace</span> = <span class="ruby-identifier">class_for</span>(<span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_namespace</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">namespace</span> = <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_namespace</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Convert e.g. 'strstr' to 'Strstr' as an equivalent constant</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-string">'A'</span><span class="ruby-operator">..</span><span class="ruby-string">'Z'</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">func</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">chr</span>)
      <span class="ruby-identifier">namespace</span>.<span class="ruby-identifier">const_set</span>(<span class="ruby-identifier">func</span>, <span class="ruby-ivar">@api</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">func_upper</span> = <span class="ruby-identifier">func</span>.<span class="ruby-identifier">dup</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">func_upper</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">chr</span> <span class="ruby-operator">==</span> <span class="ruby-string">'_'</span>
        <span class="ruby-identifier">func_upper</span> = <span class="ruby-identifier">func_upper</span>[<span class="ruby-value">1</span>, <span class="ruby-identifier">func_upper</span>.<span class="ruby-identifier">length</span>]
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">func_upper</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] = <span class="ruby-identifier">func_upper</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">chr</span>.<span class="ruby-identifier">capitalize</span>
      <span class="ruby-identifier">namespace</span>.<span class="ruby-identifier">const_set</span>(<span class="ruby-identifier">func_upper</span>, <span class="ruby-ivar">@api</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Automatically define the explicit ANSI and Unicode functions</span>
    <span class="ruby-comment"># as constants as well, if appropriate.</span>
    <span class="ruby-comment">#</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_unicode</span>
      <span class="ruby-identifier">namespace</span>.<span class="ruby-identifier">const_set</span>(<span class="ruby-node">&quot;#{func}A&quot;</span>, <span class="ruby-identifier">api_a</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_a</span>
      <span class="ruby-identifier">namespace</span>.<span class="ruby-identifier">const_set</span>(<span class="ruby-node">&quot;#{func}W&quot;</span>, <span class="ruby-identifier">api_w</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_w</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Automatically define a method in the auto_namespace if the</span>
  <span class="ruby-comment"># auto_method option is set. The explicit ANSI and Unicode methods</span>
  <span class="ruby-comment"># are added as well if the auto_unicode option is set to true.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_method</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Windows</span><span class="ruby-operator">::</span><span class="ruby-constant">API</span>.<span class="ruby-identifier">auto_namespace</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">proto</span> <span class="ruby-operator">==</span> <span class="ruby-string">'V'</span>
      <span class="ruby-identifier">proto</span> = <span class="ruby-string">''</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">n</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">proto</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
        <span class="ruby-identifier">proto</span> = <span class="ruby-identifier">proto</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">''</span>).<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">n</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
          <span class="ruby-identifier">e</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">to_s</span>
        }.<span class="ruby-identifier">join</span>(<span class="ruby-string">', '</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">proto</span> = <span class="ruby-identifier">proto</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">n</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
          <span class="ruby-identifier">e</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">to_s</span>
        }.<span class="ruby-identifier">join</span>(<span class="ruby-string">', '</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Use the upper case function equivalent if defined</span>
    <span class="ruby-identifier">call_func</span> = <span class="ruby-identifier">func_upper</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">func</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@boolean</span>
      <span class="ruby-identifier">string</span> = <span class="ruby-string">            module #{Windows::API.auto_namespace}              def #{func}(#{proto})                #{call_func}.call(#{proto}) != 0              end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_a</span>
        <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{
          def #{func}A(#{proto})
            #{call_func}A.call(#{proto}) != 0
          end
        }</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_w</span>
        <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{
          def #{func}W(#{proto})
            #{call_func}W.call(#{proto}) != 0
          end
        }</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">'end'</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">string</span> = <span class="ruby-string">            module #{Windows::API.auto_namespace}              def #{func}(#{proto})                #{call_func}.call(#{proto})              end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_a</span>
        <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{
          def #{func}A(#{proto})
            #{call_func}A.call(#{proto})
          end
        }</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_w</span>
        <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{
          def #{func}W(#{proto})
            #{call_func}W.call(#{proto})
          end
        }</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Create aliases for methods with an underscore that do not</span>
      <span class="ruby-comment"># require an underscore, e.g. umask and _umask.</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">func</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">chr</span> <span class="ruby-operator">==</span> <span class="ruby-string">'_'</span>
        <span class="ruby-identifier">func_alias</span> = <span class="ruby-identifier">func</span>[<span class="ruby-value">1</span>, <span class="ruby-identifier">func</span>.<span class="ruby-identifier">length</span>]
        <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;alias #{func_alias} #{func}\n&quot;</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">'end'</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">eval</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="call-method" class="method-detail ">
          <a name="method-i-call"></a>

          
          <div class="method-heading">
            <span class="method-name">call</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Calls the function name set in the constructor.</p>
            

            
            <div class="method-source-code" id="call-source">
<pre>
<span class="ruby-comment"># File lib/windows/api.rb, line 488</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">call</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-ivar">@api</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- call-source -->
            
          </div>

          

          
        </div><!-- call-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

