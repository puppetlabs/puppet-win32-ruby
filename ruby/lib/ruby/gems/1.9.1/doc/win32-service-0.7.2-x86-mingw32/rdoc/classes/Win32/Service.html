<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Win32::Service</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Win32::Service</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/win32/service_rb.html">
                lib/win32/service.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The <a href="Service.html">Service</a> class encapsulates <a
href="Service.html#M000017">services</a> controller actions, such as
creating, starting, configuring or deleting <a
href="Service.html#M000017">services</a>.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000015">config_info</a>&nbsp;&nbsp;
      <a href="#M000006">configure</a>&nbsp;&nbsp;
      <a href="#M000014">delete</a>&nbsp;&nbsp;
      <a href="#M000007">exists?</a>&nbsp;&nbsp;
      <a href="#M000008">get_display_name</a>&nbsp;&nbsp;
      <a href="#M000009">get_service_name</a>&nbsp;&nbsp;
      <a href="#M000005">new</a>&nbsp;&nbsp;
      <a href="#M000012">pause</a>&nbsp;&nbsp;
      <a href="#M000013">resume</a>&nbsp;&nbsp;
      <a href="#M000017">services</a>&nbsp;&nbsp;
      <a href="#M000010">start</a>&nbsp;&nbsp;
      <a href="#M000016">status</a>&nbsp;&nbsp;
      <a href="#M000011">stop</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">Windows::Error</span>
        <span class="include-name">Windows::Service</span>
        <span class="include-name">Windows::File</span>
        <span class="include-name">Windows::Process</span>
        <span class="include-name">Windows::Security</span>
        <span class="include-name">Windows::MSVCRT::String</span>
        <span class="include-name">Windows::MSVCRT::Buffer</span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="Service/Error.html" class="link">Win32::Service::Error</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">VERSION</td>
          <td>=</td>
          <td class="context-item-value">'0.7.2'</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The version of the win32-service library

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_ALL_ACCESS</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_ALL_ACCESS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Includes STANDARD_RIGHTS_REQUIRED, in addition to all other rights

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_CREATE_SERVICE</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_CREATE_SERVICE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the CreateService function

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_CONNECT</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_CONNECT</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to connect to the service control manager.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_ENUMERATE_SERVICE</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_ENUMERATE_SERVICE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the EnumServicesStatusEx function to list <a
href="Service.html#M000017">services</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_LOCK</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_LOCK</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the LockServiceDatabase function

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_MODIFY_BOOT_CONFIG</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_MODIFY_BOOT_CONFIG</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the NotifyBootConfigStatus function

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MANAGER_QUERY_LOCK_STATUS</td>
          <td>=</td>
          <td class="context-item-value">SC_MANAGER_QUERY_LOCK_STATUS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the QueryServiceLockStatus function

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ALL_ACCESS</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_ALL_ACCESS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Includes STANDARD_RIGHTS_REQUIRED in addition to all access rights

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CHANGE_CONFIG</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CHANGE_CONFIG</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call functions that <a
href="Service.html#M000006">configure</a> existing <a
href="Service.html#M000017">services</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ENUMERATE_DEPENDENTS</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_ENUMERATE_DEPENDENTS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to enumerate all the <a href="Service.html#M000017">services</a>
dependent on the service

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">INTERROGATE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_INTERROGATE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to make a service report its <a
href="Service.html#M000016">status</a> immediately

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PAUSE_CONTINUE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_PAUSE_CONTINUE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to control a service with a <a
href="Service.html#M000012">pause</a> or <a
href="Service.html#M000013">resume</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">QUERY_CONFIG</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_QUERY_CONFIG</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to be able to gather configuration information about a service

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">QUERY_STATUS</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_QUERY_STATUS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to be ask the SCM about the <a
href="Service.html#M000016">status</a> of a service

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">START</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_START</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the StartService function to <a
href="Service.html#M000010">start</a> the service.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STOP</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_STOP</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call the ControlService function to <a
href="Service.html#M000011">stop</a> the service.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">USER_DEFINED_CONTROL</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_USER_DEFINED_CONTROL</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Required to call ControlService with a user defined control code

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">KERNEL_DRIVER</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_KERNEL_DRIVER</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Driver service

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">FILE_SYSTEM_DRIVER</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_FILE_SYSTEM_DRIVER</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
File system driver service

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">WIN32_OWN_PROCESS</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_WIN32_OWN_PROCESS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> that runs in its own process

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">WIN32_SHARE_PROCESS</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_WIN32_SHARE_PROCESS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> that shares a process with one or more
other <a href="Service.html#M000017">services</a>.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">INTERACTIVE_PROCESS</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_INTERACTIVE_PROCESS</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The service can interact with the desktop

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DRIVER</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_DRIVER</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TYPE_ALL</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_TYPE_ALL</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BOOT_START</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_BOOT_START</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A service started automatically by the SCM during system startup

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SYSTEM_START</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_SYSTEM_START</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A device driver started by the IoInitSystem function. Drivers only

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">AUTO_START</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_AUTO_START</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A service started automatically by the SCM during system startup

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEMAND_START</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_DEMAND_START</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A service started by the SCM when a process calls StartService

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DISABLED</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_DISABLED</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A service that cannot be started

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ERROR_IGNORE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_ERROR_IGNORE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service/Error.html">Error</a> logged, startup continues

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ERROR_NORMAL</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_ERROR_NORMAL</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service/Error.html">Error</a> logged, pop up message, startup
continues

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ERROR_SEVERE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_ERROR_SEVERE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service/Error.html">Error</a> logged, startup continues, system
restarted last known good config

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ERROR_CRITICAL</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_ERROR_CRITICAL</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service/Error.html">Error</a> logged, startup fails, system
restarted last known good config

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STOPPED</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_STOPPED</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> is not running

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">START_PENDING</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_START_PENDING</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> has received a <a
href="Service.html#M000010">start</a> signal but is not yet running

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STOP_PENDING</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_STOP_PENDING</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> has received a <a
href="Service.html#M000011">stop</a> signal but is not yet stopped

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">RUNNING</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_RUNNING</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> is running

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTINUE_PENDING</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTINUE_PENDING</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> has received a signal to <a
href="Service.html#M000013">resume</a> but is not yet running

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PAUSE_PENDING</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_PAUSE_PENDING</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> has received a signal to <a
href="Service.html#M000012">pause</a> but is not yet paused

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PAUSED</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_PAUSED</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
<a href="Service.html">Service</a> is paused

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_STOP</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_STOP</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies service that it should <a href="Service.html#M000011">stop</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_PAUSE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_PAUSE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies service that it should <a href="Service.html#M000012">pause</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_CONTINUE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_CONTINUE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies service that it should <a href="Service.html#M000013">resume</a>

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_INTERROGATE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_INTERROGATE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies service that it should return its current <a
href="Service.html#M000016">status</a> information

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_PARAMCHANGE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_PARAMCHANGE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies a service that its parameters have changed

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_NETBINDADD</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_NETBINDADD</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies a service that there is a <a href="Service.html#M000005">new</a>
component for binding

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_NETBINDREMOVE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_NETBINDREMOVE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies a service that a component for binding has been removed

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_NETBINDENABLE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_NETBINDENABLE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies a service that a component for binding has been enabled

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONTROL_NETBINDDISABLE</td>
          <td>=</td>
          <td class="context-item-value">SERVICE_CONTROL_NETBINDDISABLE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Notifies a service that a component for binding has been disabled

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ACTION_NONE</td>
          <td>=</td>
          <td class="context-item-value">SC_ACTION_NONE</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
No action

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ACTION_REBOOT</td>
          <td>=</td>
          <td class="context-item-value">SC_ACTION_REBOOT</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Reboot the computer

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ACTION_RESTART</td>
          <td>=</td>
          <td class="context-item-value">SC_ACTION_RESTART</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Restart the service

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ACTION_RUN_COMMAND</td>
          <td>=</td>
          <td class="context-item-value">SC_ACTION_RUN_COMMAND</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Run a command

</td>
        </tr>
        </table>
      </div>
    </div>

    <div id="aliases-list">
      <h3 class="section-bar">External Aliases</h3>

      <div class="name-list">
                        <table summary="aliases">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">new</td>
          <td>-&gt;</td>
          <td class="context-item-value">create</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">get_display_name</td>
          <td>-&gt;</td>
          <td class="context-item-value">getdisplayname</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">get_service_name</td>
          <td>-&gt;</td>
          <td class="context-item-value">getservicename</td>
        </tr>
                        </table>
      </div>
    </div>


      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="Service.src/M000015.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000015.html');return false;">
          <span class="method-name">config_info</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a ServiceConfigInfo struct containing the configuration information
about <tt>service</tt> on <tt>host</tt>, or the local host if no host is
specified.
</p>
<p>
Example:
</p>
<pre>
  Service.config_info('W32Time') =&gt; &lt;struct ServiceConfigInfo ...&gt;
</pre>
        </div>
      </div>

      <div id="method-M000006" class="method-detail">
        <a name="M000006"></a>

        <div class="method-heading">
          <a href="Service.src/M000006.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000006.html');return false;">
          <span class="method-name">configure</span><span class="method-args">(options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Configures the named <tt>service</tt> on <tt>host</tt>, or the local host
if no host is specified. The <tt>options</tt> parameter is a hash that can
contain any of the following parameters:
</p>
<ul>
<li>service_type

</li>
<li>start_type

</li>
<li>error_control

</li>
<li>binary_path_name

</li>
<li>load_order_group

</li>
<li>dependencies

</li>
<li>service_start_name

</li>
<li>password (used with service_start_name)

</li>
<li>display_name

</li>
<li>description

</li>
<li>failure_reset_period

</li>
<li>failure_reboot_message

</li>
<li>failure_command

</li>
<li>failure_actions

</li>
<li>failure_delay

</li>
</ul>
<p>
Examples:
</p>
<pre>
   # Configure only the display name
   Service.configure(
     :service_name =&gt; 'some_service',
     :display_name =&gt; 'Test 33'
   )

   # Configure everything
   Service.configure(
      :service_name       =&gt; 'some_service'
      :service_type       =&gt; Service::WIN32_OWN_PROCESS,
      :start_type         =&gt; Service::AUTO_START,
      :error_control      =&gt; Service::ERROR_NORMAL,
      :binary_path_name   =&gt; 'C:\path\to\some_service.exe',
      :load_order_group   =&gt; 'Network',
      :dependencies       =&gt; ['W32Time','Schedule']
      :service_start_name =&gt; 'SomeDomain\\User',
      :password           =&gt; 'XXXXXXX',
      :display_name       =&gt; 'This is some service',
      :description        =&gt; 'A custom service I wrote just for fun'
   )
</pre>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="Service.src/M000014.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000014.html');return false;">
          <span class="method-name">delete</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes the specified <tt>service</tt> from <tt>host</tt>, or the local
host if no host is specified. Returns self.
</p>
<p>
Technical note. This method is not instantaneous. The service is first
marked for deletion from the service control manager database. Then all
handles to the service are closed. Then an attempt to <a
href="Service.html#M000011">stop</a> the service is made. If the service
cannot be stopped, the service control manager database entry is removed
when the system is restarted.
</p>
<p>
Example:
</p>
<pre>
  Service.delete('SomeService') =&gt; self
</pre>
        </div>
      </div>

      <div id="method-M000007" class="method-detail">
        <a name="M000007"></a>

        <div class="method-heading">
          <a href="Service.src/M000007.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000007.html');return false;">
          <span class="method-name">exists?</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not <tt>service</tt> exists on <tt>host</tt> or
localhost, if no host is specified.
</p>
<p>
Example:
</p>
<p>
Service.exists?(&#8216;W32Time&#8217;) =&gt; true
</p>
        </div>
      </div>

      <div id="method-M000008" class="method-detail">
        <a name="M000008"></a>

        <div class="method-heading">
          <a href="Service.src/M000008.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000008.html');return false;">
          <span class="method-name">get_display_name</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the display name of the specified service name, i.e. the string
displayed in the Services GUI. Raises a <a
href="Service/Error.html">Service::Error</a> if the service name cannot be
found.
</p>
<p>
If a <tt>host</tt> is provided, the information will be retrieved from that
host. Otherwise, the information is pulled from the local host (the default
behavior).
</p>
<p>
Example:
</p>
<p>
<a
href="Service.html#M000008">Service.get_display_name</a>(&#8216;W32Time&#8217;)
=&gt; &#8216;Windows Time&#8216;
</p>
        </div>
      </div>

      <div id="method-M000009" class="method-detail">
        <a name="M000009"></a>

        <div class="method-heading">
          <a href="Service.src/M000009.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000009.html');return false;">
          <span class="method-name">get_service_name</span><span class="method-args">(display_name, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the service name of the specified service from the provided
<tt>display_name</tt>. Raises a <a
href="Service/Error.html">Service::Error</a> if the <tt>display_name</tt>
cannote be found.
</p>
<p>
If a <tt>host</tt> is provided, the information will be retrieved from that
host. Otherwise, the information is pulled from the local host (the default
behavior).
</p>
<p>
Example:
</p>
<p>
<a href="Service.html#M000009">Service.get_service_name</a>(&#8216;Windows
Time&#8217;) =&gt; &#8216;W32Time&#8216;
</p>
        </div>
      </div>

      <div id="method-M000005" class="method-detail">
        <a name="M000005"></a>

        <div class="method-heading">
          <a href="Service.src/M000005.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000005.html');return false;">
          <span class="method-name">new</span><span class="method-args">(options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Service.html#M000005">new</a> service with the specified
<tt>options</tt>. A <tt>service_name</tt> must be specified or an
ArgumentError is raised. A <tt>host</tt> option may be specified. If no
host is specified the local machine is used.
</p>
<p>
Possible Options:
</p>
<ul>
<li>service_name =&gt; nil (you must specify)

</li>
<li>host =&gt; nil (optional)

</li>
<li>display_name =&gt; service_name

</li>
<li>desired_access =&gt; Service::ALL_ACCESS

</li>
<li>service_type =&gt; Service::WIN32_OWN_PROCESS |

<pre>
                          Service::INTERACTIVE_PROCESS
</pre>
</li>
<li>start_type =&gt; Service::DEMAND_START

</li>
<li>error_control =&gt; Service::ERROR_NORMAL

</li>
<li>binary_path_name =&gt; nil

</li>
<li>load_order_group =&gt; nil

</li>
<li>dependencies =&gt; nil

</li>
<li>service_start_name =&gt; nil

</li>
<li>password =&gt; nil

</li>
<li>description =&gt; nil

</li>
<li>failure_reset_period =&gt; nil,

</li>
<li>failure_reboot_message =&gt; nil,

</li>
<li>failure_command =&gt; nil,

</li>
<li>failure_actions =&gt; nil,

</li>
<li>failure_delay =&gt; 0

</li>
</ul>
<p>
Example:
</p>
<pre>
   # Configure everything
   Service.new(
     :service_name       =&gt; 'some_service',
     :host               =&gt; 'localhost',
     :service_type       =&gt; Service::WIN32_OWN_PROCESS,
     :description        =&gt; 'A custom service I wrote just for fun',
     :start_type         =&gt; Service::AUTO_START,
     :error_control      =&gt; Service::ERROR_NORMAL,
     :binary_path_name   =&gt; 'C:\path\to\some_service.exe',
     :load_order_group   =&gt; 'Network',
     :dependencies       =&gt; ['W32Time','Schedule'],
     :service_start_name =&gt; 'SomeDomain\\User',
     :password           =&gt; 'XXXXXXX',
     :display_name       =&gt; 'This is some service',
   )
</pre>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="Service.src/M000012.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000012.html');return false;">
          <span class="method-name">pause</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pauses the given <tt>service</tt> on <tt>host</tt>, or the local host if no
host is specified. Returns self
</p>
<p>
Note that pausing a service that is already paused will have no effect and
it will not raise an error.
</p>
<p>
Be aware that not all <a href="Service.html#M000017">services</a> are
configured to accept a <a href="Service.html#M000012">pause</a> command.
Attempting to <a href="Service.html#M000012">pause</a> a service that
isn&#8216;t setup to receive a <a href="Service.html#M000012">pause</a>
command will raise an error.
</p>
<p>
Example:
</p>
<pre>
   Service.pause('Schedule') =&gt; self
</pre>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="Service.src/M000013.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000013.html');return false;">
          <span class="method-name">resume</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Resume the given <tt>service</tt> on <tt>host</tt>, or the local host if no
host is specified. Returns self.
</p>
<p>
Note that resuming a service that&#8216;s already running will have no
effect and it will not raise an error.
</p>
<p>
Example:
</p>
<pre>
   Service.resume('Schedule') =&gt; self
</pre>
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="Service.src/M000017.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000017.html');return false;">
          <span class="method-name">services</span><span class="method-args">(host=nil, group=nil) {|struct| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Enumerates over a list of service types on <tt>host</tt>, or the local
machine if no host is specified, yielding a ServiceInfo struct for each
service.
</p>
<p>
If a <tt>group</tt> is specified, then only those <a
href="Service.html#M000017">services</a> that belong to that load order
group are enumerated. If an empty string is provided, then only <a
href="Service.html#M000017">services</a> that do not belong to any group
are enumerated. If this parameter is nil (the default), group membership is
ignored and all <a href="Service.html#M000017">services</a> are enumerated.
This value is not case sensitive.
</p>
<p>
Examples:
</p>
<pre>
   # Enumerate over all services on the localhost
   Service.services{ |service| p service }

   # Enumerate over all services on a remote host
   Service.services('some_host'){ |service| p service }

   # Enumerate over all 'network' services locally
   Service.services(nil, 'network'){ |service| p service }
</pre>
        </div>
      </div>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="Service.src/M000010.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000010.html');return false;">
          <span class="method-name">start</span><span class="method-args">(service, host=nil, *args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Attempts to <a href="Service.html#M000010">start</a> the named
<tt>service</tt> on <tt>host</tt>, or the local machine if no host is
provided. If <tt>args</tt> are provided, they are passed to the
Daemon#service_main method.
</p>
<p>
Examples:
</p>
<pre>
   # Start 'SomeSvc' on the local machine
   Service.start('SomeSvc', nil) =&gt; self

   # Start 'SomeSvc' on host 'foo', passing 'hello' as an argument
   Service.start('SomeSvc', 'foo', 'hello') =&gt; self
</pre>
        </div>
      </div>

      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">
          <a href="Service.src/M000016.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000016.html');return false;">
          <span class="method-name">status</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a ServiceStatus struct indicating the <a
href="Service.html#M000016">status</a> of service <tt>name</tt> on
<tt>host</tt>, or the localhost if none is provided.
</p>
<p>
Example:
</p>
<p>
<a href="Service.html#M000016">Service.status</a>(&#8216;W32Time&#8217;)
=&gt; &lt;struct Struct::ServiceStatus &#8230;&gt;
</p>
        </div>
      </div>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="Service.src/M000011.html" target="Code" class="method-signature"
            onclick="popupCode('Service.src/M000011.html');return false;">
          <span class="method-name">stop</span><span class="method-args">(service, host=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Stops a the given <tt>service</tt> on <tt>host</tt>, or the local host if
no host is specified. Returns self.
</p>
<p>
Note that attempting to <a href="Service.html#M000011">stop</a> an already
stopped service raises <a href="Service/Error.html">Service::Error</a>.
</p>
<p>
Example:
</p>
<pre>
   Service.stop('W32Time') =&gt; self
</pre>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>