<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: CHANGES</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>CHANGES</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>CHANGES
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Tue Jan 24 22:11:26 -0800 2012</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h2>0.7.2 - 7-Sep-2011</h2>
<ul>
<li>Now works with mingw compiler by skipping __try and __finally if using
mingw, or using them with mingw if the seh.h header is found.

</li>
<li>The binary gem now contains binaries for both Ruby 1.8.7 and 1.9.2 using a
simple wrapper.

</li>
<li>Updated some Rake tasks.

</li>
</ul>
<h2>0.7.1 - 9-Feb-2010</h2>
<ul>
<li>Compatibility fixes for 1.9.x.

</li>
<li>Fixed a bug where the controls_accepted struct member was always nil. This
has been fixed and now always returns an array.

</li>
<li>Added &#8216;pre-shutdown&#8217; as possible values for the list of
controls accepted.

</li>
<li>Changed test-unit from a runtime dependency to a development dependency.

</li>
<li>Some tests were refactored to be more reliable.

</li>
<li>Refactored the Rakefile and gemspec.

</li>
</ul>
<h2>0.7.0 - 30-Jun-2009</h2>
<ul>
<li>INTERFACE CHANGE: The Service.new and Service.configure methods now accept
a single hash argument only. The :service_name key is mandatory, while the
:host key is optional.

</li>
<li>Fixed a bug in the Service.services method where a segfault would occur if
the binary_path_name was greater than 260 characters. The buffer size has
been increased to 1024 characters. Thanks go to Dan Daniels for the spot.

</li>
<li>Altered the Daemon class so that the Ruby interpreter was not invoked
within the Service_Main function. The functions that close stdin, stdout
and stderr are now called within the mainloop method. Thanks go to Tim
Hanson for the spot and the patch.

</li>
<li>Eliminated a minor build warning in daemon.c

</li>
<li>License changed to Artistic 2.0, with corresponding gemspec update.

</li>
<li>Added an uninstall rake task.

</li>
<li>Updated the service_stop method in the demo_daemon.rb file, and added some
additional comments.

</li>
<li>The test files were renamed.

</li>
<li>Several tests were updated and refactored to use Test::Unit 2.x. That
library is now a dependency.

</li>
<li>The &#8216;uninstall&#8217; Rakefile task is now more verbose.

</li>
</ul>
<h2>0.6.1 - 1-Jan-2008</h2>
<ul>
<li>The Service.services method now handles the scenario where a particular
service may still exist, but its underlying registry entry has been
deleted. In this case, most ServiceInfo struct members are set to nil and a
warning is issued.

</li>
<li>RDoc updates.

</li>
</ul>
<h2>0.6.0 - 25-Nov-2007</h2>
<ul>
<li>The Service control class is now pure Ruby. The Daemon class is still C,
however. That may change in the future. This means the windows-pr library
is now a prerequisite.

</li>
<li>The Service.new method has been altered in a way that is not backwards
compatible. It is now the same as Service.create.

</li>
<li>The Service.start method now properly handles arguments to the
Daemon#service_main method.

</li>
<li>The Daemon source code is now separate from the Service control class
source code. That means you must require them separately, as needed.

</li>
<li>The Daemon class should be much more responsive to service events now,
especially service_stop. Many thanks go to Kevin Burge for the patch.

</li>
<li>Added the Daemon.mainloop method as a shortcut for Daemon.new.mainloop.

</li>
<li>The Daemon class now redirects STDIN, STDOUT and STDERR to the NUL device
if they&#8216;re still associated with a terminal when the service starts.
This should help prevent Errno::EBADF errors.

</li>
<li>The Service.services class method now supports the group parameter for
versions of Ruby built with older compilers, i.e. it will now work with the
one-click Ruby installer.

</li>
<li>The Service.getdisplayname method was changed to Service.get_display_name.
An alias has been provided for backwards compatibility.

</li>
<li>The Service.getservicename method was changed to Service.get_service_name.
An alias has been provided for backwards compatibility.

</li>
<li>Added the Service.config_info method.

</li>
<li>The Service.create and Service.configure methods now allow you to set
failure actions, failure commands, and reset/retry periods.

</li>
<li>Improved test suite.

</li>
<li>Changed &#8216;tdaemon.rb&#8217;, &#8216;tdaemon_ctl.rb&#8217; and
&#8216;service_test.rb&#8217; to &#8216;demo_daemon.rb&#8217;,
&#8216;demo_daemon_ctl.rb&#8217; and &#8216;demo_services.rb&#8217;,
respectively.

</li>
<li>Some refactoring and updates to the demo daemon and demo daemon controller
examples.

</li>
<li>The Win32Service struct is now ServiceInfo.

</li>
<li>ServiceError is now Service::Error.

</li>
<li>DaemonError is now Daemon::Error.

</li>
<li>Some documentation improvements, corrections and updates.

</li>
</ul>
<h2>0.5.2 - 25-Nov-2006</h2>
<ul>
<li>Fixed a bug in the Daemon class where the service event handling methods
(most notably service_stop) did not work properly due to thread blocking
issues. Many thanks go to Patrick Hurley for the patch.

</li>
<li>Added the Daemon#running? method as helper method for your service_main
method.

</li>
<li>The &#8216;interactive?&#8217; struct member is now just
&#8216;interactive&#8217;. This was supposed to have been in the last
release but was somehow missed. Sorry.

</li>
<li>Scrapped the old daemon_test.rb file and split it into two new files -
tdaemon.rb and tdaemon_ctl.rb. In the process a few bugs were fixed.

</li>
<li>Added a gemspec.

</li>
<li>Documentation and test suite updates.

</li>
</ul>
<h2>0.5.1 - 18-Jun-2006</h2>
<ul>
<li>Added the Service.open method.

</li>
<li>The Service.new method now accepts a block, and automatically closes itself
at the end of the block.

</li>
<li>Fixed in a bug in the Service.create method where setting dependencies was
not working properly. Thanks go to Scott Harper for the spot.

</li>
<li>The &#8216;interactive?&#8217; struct member is now just
&#8216;interactive&#8217; since Ruby no longer supports question marks in
struct member names. UGH.

</li>
<li>The block for Service#configure_service is no longer optional.

</li>
<li>Replaced ClipSrv with W32Time for most of the test methods in tc_service.rb
because it had a dependency that is disabled on most systems.

</li>
<li>Added a tweak to the extconf.rb file to help with the test suite.

</li>
<li>Some documentation updates and corrections.

</li>
</ul>
<h2>0.5.0 - 26-Nov-2005</h2>
<ul>
<li>Added a service_init hook, and (internally) altered the way the service
starts. This was done to deal with services that need to perform any
initialization in the Daemon itself before the service starts. Previously
this would result in the service timing out during startup.

<p>
Thanks go to Jamey Cribbs for spotting the problem.
</p>
</li>
<li>Modified the Daemon example, adding a service_init hook that does about 10
seconds worth of initialization before finally starting. See the comments
in examples\daemon_test.rb for more information.

</li>
<li>Minor test and README changes.

</li>
</ul>
<h2>0.4.6 - 24-May-2005</h2>
<ul>
<li>Fixed an initialization bug that could cause Daemons to fail unless the
win32-service package was the last package require&#8216;d.

</li>
<li>Altered the Service.start method. It now takes any number of arguments
(after the service and host name). These arguments are passed to the
service&#8216;s Service_Main() function.

</li>
<li>The Service.services method now returns an Array of ServiceStruct&#8216;s
in non-block form.

</li>
<li>The Service.start, Service.pause, Service.resume, Service.stop and
Service.delete methods now return the class (self), not &#8216;true&#8217;.

</li>
<li>Added the ability to add or configure the service description in
Service#create_service or Service#configure, respectively.

</li>
<li>Fixed a bug in the Service.start method where false positives could result.

</li>
<li>Updated the ServiceStatus struct to include pid and service_flags on Win2k
or later.

</li>
<li>Unicode is now the default setting as far as internal string handling. It
will still work fine with &#8216;regular&#8217; text.

</li>
<li>Added safe string handling for string input values.

</li>
<li>Added rdoc comments into the C source.

</li>
<li>Made the service.txt and daemon.txt files rdoc friendly.

</li>
<li>Removed the service.rd and daemon.rd files. If you want html documentation,
run rdoc over the service.txt and daemon.txt files.

</li>
<li>The dreaded &quot;code cleanup&quot;.

</li>
</ul>
<h2>0.4.5 - 28-Feb-2005</h2>
<ul>
<li>Fixed an accessor bug in Service#create. Thanks go to Nathaniel Talbott for
the spot.

</li>
<li>Eliminated a warning that appeared starting in Ruby 1.8.2 regarding Struct
redefinitions.

</li>
<li>Moved &#8216;examples&#8217; directory to toplevel directory.

</li>
<li>Deleted the &#8216;test2.rb&#8217; example. This was supplanted by the
&#8216;daemon_test.rb&#8217; script.

</li>
<li>Renamed the &#8216;test.rb&#8217; file to &#8216;services_test.rb&#8217;.

</li>
<li>Made this document rdoc friendly.

</li>
</ul>
<h2>0.4.4 - 27-Aug-2004</h2>
<ul>
<li>Modified the Service class to use the newer allocation framework. The
Daemon class already used this, hence no major version bump.

</li>
<li>Fixed in a bug in the create_service() method with regards to the
&#8216;dependencies&#8217; option and null arguments (you no longer need to
specify an empty array).

</li>
</ul>
<h2>0.4.3 - 14-Aug-2004</h2>
<ul>
<li>Fixed the Daemon class by adding back the constants it needed in order to
run. I accidentally broke this when I changed the Daemon class from being a
subclass of Service to being its own class.

</li>
<li>Added a separate test suite for the Daemon class, tc_daemon.rb, to help me
from making that mistake ever again. :)

</li>
<li>Updated the daemon_test.rb script a bit to report error messages should any
occur.

</li>
<li>Minor doc updates

</li>
</ul>
<h2>0.4.2 - 10-Jul-2004</h2>
<ul>
<li>The Daemon class is no longer a subclass of Service.

</li>
<li>Added the &#8216;pid&#8217; and &#8216;service_flags&#8217; struct members
to the Win32Service struct. These members are only available to folks using
Windows 2000 or later and who compile with VC++ 7.0 or later (including the
.NET SDK).

</li>
<li>The Service.services method now accepts a group name as an optional third
argument. Again, you must be using Windows 2000 or later and compile with
VC++ 7.0 or later (including the .NET SDK).

</li>
<li>The deprecated STR2CSTR() functions were replaced with StringValuePtr().
This also means that as of this version, win32-service requires Ruby 1.8.0
or greater.

</li>
<li>Moved the sample programs to doc/examples

</li>
<li>Removed the .html files under /doc. You can generate that on your own if
you like.

</li>
</ul>
<h2>0.4.1 - 14-Mar-2004</h2>
<ul>
<li>Added the exists? class method and corresponding test suite additions.

</li>
<li>Pushed the ServiceError and DaemonError classes under the <a
href="../classes/Win32.html">Win32</a> module.

</li>
<li>Normalized tc_service.rb so that it can be run outside of the test
directory more easily.

</li>
</ul>
<h2>0.4.0 - 9-Feb-2004</h2>
<ul>
<li>Changed &quot;worker&quot; method to &quot;service_main&quot; method.

</li>
<li>Added event hooks for stop, pause, resume, etc. See the documentation for
further details. (Thanks Park Heesob)

</li>
<li>Some of the Daemon functions were raising ServiceError. They have been
changed to DaemonError.

</li>
<li>Updated the daemon_test.rb file to use the new event hooks.

</li>
<li>Documentation additions and updates.

</li>
</ul>
<h2>0.3.0 - 31-Jan-2004</h2>
<ul>
<li>Added a Daemon subclass. This allows you to run Ruby programs as a service.
Please see the documentation for more details. (Thanks Park Heesob). This
should be considered an ALPHA release.

</li>
<li>The Win32ServiceError class has been renamed to just ServiceError. I felt
the &quot;<a href="../classes/Win32.html">Win32</a>&quot; was redundant,
given that it&#8216;s already under the <a
href="../classes/Win32.html">Win32</a> module.

</li>
<li>In some cases a bogus error description was being returned because the
GetLastError() function was being called too late. This has been fixed.
(Thanks Park Heesob).

</li>
<li>The explicit garbage collection has been removed because what I thought was
a memory leak was not, in fact, a memory leak. In addition, it was hurting
performance badly.

</li>
<li>The &quot;\r\n&quot; is now automatically stripped from error messages.
This was causing slightly garbled error messages. (Thanks Park Heesob).

</li>
<li>Added explicit closing of the Service Control Manager handle in the
services() function for those rare cases where it may fail while reading
service information.

</li>
<li>Made some of the error strings a bit more descriptive.

</li>
<li>Test suite and documentation additions, including a sample daemon program
in the test directory called &quot;daemon_test.rb&quot;.

</li>
</ul>
<h2>0.2.2 - 15-Jan-2004</h2>
<ul>
<li>Fixed a mistake in the service_init declaration within Init_service().

</li>
<li>Fixed bug in the service_init function with regards to desired access.

</li>
<li>Modified service_free() function to explicitly set the hSCManager handle to
NULL and modified the service_close() method to test hSCManager handle for
NULL value. This should eliminate accidentally trying to close an already
closed handle, which may have happened as the result of a free() call.
(Thanks Park Heesob).

</li>
<li>Added explicit garbage collection in Service.services() method.

</li>
<li>More explicit about closing open HANDLE&#8216;s when error conditions
arise.

</li>
</ul>
<h2>0.2.1 - 2-Nov-2003</h2>
<ul>
<li>Made the exported less redundant and less verbose, e.g.
Service::SERVICE_DISABLED is now just Service::DISABLED. The same is true
for the service control constants, i.e. the &#8216;SC_&#8217; has been
removed.

</li>
<li>Corresponding test suite changes.

</li>
</ul>
<h2>0.2.0 - 16-Oct-2003</h2>
<ul>
<li>The constructor has been changed. It now only takes a machine name and a
desired access for arguments. The keyword arguments are now part of the
create_service method() and only in block form. See the documentation for
more details.

</li>
<li>Added a configure_service() and close() instance methods.

</li>
<li>Added several new constants to allow finer control over created and
configured services.

</li>
<li>Added Win32ServiceError as an exception. All failures now raise this error
instead of a vanilla StandardError.

</li>
<li>Moved some common code into the service.h file.

</li>
</ul>
<h2>0.1.0 - 10-Oct-2003</h2>
<ul>
<li>Initial release

</li>
</ul>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>