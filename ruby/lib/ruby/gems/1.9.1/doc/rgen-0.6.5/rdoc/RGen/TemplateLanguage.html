<?xml version="1.0" encoding="IBM437"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=IBM437" http-equiv="Content-Type" />

  <title>Module: RGen::TemplateLanguage</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="module">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/rgen/template_language/directory_template_container_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rgen/template_language/directory_template_container.rb">lib/rgen/template_language/directory_template_container.rb</a></li>
          
            <li><a href="../lib/rgen/template_language/output_handler_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rgen/template_language/output_handler.rb">lib/rgen/template_language/output_handler.rb</a></li>
          
            <li><a href="../lib/rgen/template_language/template_container_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rgen/template_language/template_container.rb">lib/rgen/template_language/template_container.rb</a></li>
          
            <li><a href="../lib/rgen/template_language/template_helper_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rgen/template_language/template_helper.rb">lib/rgen/template_language/template_helper.rb</a></li>
          
            <li><a href="../lib/rgen/template_language_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rgen/template_language.rb">lib/rgen/template_language.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">MODULE</span> <a href="TemplateLanguage/TemplateHelper.html">RGen::TemplateLanguage::TemplateHelper</a></li>
          
          <li><span class="type">CLASS</span> <a href="TemplateLanguage/DirectoryTemplateContainer.html">RGen::TemplateLanguage::DirectoryTemplateContainer</a></li>
          
          <li><span class="type">CLASS</span> <a href="TemplateLanguage/OutputHandler.html">RGen::TemplateLanguage::OutputHandler</a></li>
          
          <li><span class="type">CLASS</span> <a href="TemplateLanguage/TemplateContainer.html">RGen::TemplateLanguage::TemplateContainer</a></li>
          
        </ul>
      </div>
      

      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../CHANGELOG.html">CHANGELOG</a></li>
        
          <li class="file"><a href="../MIT-LICENSE.html">MIT-LICENSE</a></li>
        
          <li class="file"><a href="../README_rdoc.html">README.rdoc</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../RGen.html">RGen</a></li>
        
          <li><a href="../RGen/ECore.html">RGen::ECore</a></li>
        
          <li><a href="../RGen/ECore/EAnnotation.html">RGen::ECore::EAnnotation</a></li>
        
          <li><a href="../RGen/ECore/EAttribute.html">RGen::ECore::EAttribute</a></li>
        
          <li><a href="../RGen/ECore/EAttribute/ClassModule.html">RGen::ECore::EAttribute::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/EClass.html">RGen::ECore::EClass</a></li>
        
          <li><a href="../RGen/ECore/EClass/ClassModule.html">RGen::ECore::EClass::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/EClassifier.html">RGen::ECore::EClassifier</a></li>
        
          <li><a href="../RGen/ECore/EClassifier/ClassModule.html">RGen::ECore::EClassifier::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/ECoreBuilderMethods.html">RGen::ECore::ECoreBuilderMethods</a></li>
        
          <li><a href="../RGen/ECore/ECoreInterface.html">RGen::ECore::ECoreInterface</a></li>
        
          <li><a href="../RGen/ECore/ECoreToRuby.html">RGen::ECore::ECoreToRuby</a></li>
        
          <li><a href="../RGen/ECore/ECoreToRuby/FeatureWrapper.html">RGen::ECore::ECoreToRuby::FeatureWrapper</a></li>
        
          <li><a href="../RGen/ECore/EDataType.html">RGen::ECore::EDataType</a></li>
        
          <li><a href="../RGen/ECore/EEnum.html">RGen::ECore::EEnum</a></li>
        
          <li><a href="../RGen/ECore/EEnumLiteral.html">RGen::ECore::EEnumLiteral</a></li>
        
          <li><a href="../RGen/ECore/EFactory.html">RGen::ECore::EFactory</a></li>
        
          <li><a href="../RGen/ECore/EGenericType.html">RGen::ECore::EGenericType</a></li>
        
          <li><a href="../RGen/ECore/EModelElement.html">RGen::ECore::EModelElement</a></li>
        
          <li><a href="../RGen/ECore/EModelElement/ClassModule.html">RGen::ECore::EModelElement::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/ENamedElement.html">RGen::ECore::ENamedElement</a></li>
        
          <li><a href="../RGen/ECore/EObject.html">RGen::ECore::EObject</a></li>
        
          <li><a href="../RGen/ECore/EOperation.html">RGen::ECore::EOperation</a></li>
        
          <li><a href="../RGen/ECore/EPackage.html">RGen::ECore::EPackage</a></li>
        
          <li><a href="../RGen/ECore/EPackage/ClassModule.html">RGen::ECore::EPackage::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/EParameter.html">RGen::ECore::EParameter</a></li>
        
          <li><a href="../RGen/ECore/EReference.html">RGen::ECore::EReference</a></li>
        
          <li><a href="../RGen/ECore/EStringToStringMapEntry.html">RGen::ECore::EStringToStringMapEntry</a></li>
        
          <li><a href="../RGen/ECore/EStructuralFeature.html">RGen::ECore::EStructuralFeature</a></li>
        
          <li><a href="../RGen/ECore/EStructuralFeature/ClassModule.html">RGen::ECore::EStructuralFeature::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/ETypeArgument.html">RGen::ECore::ETypeArgument</a></li>
        
          <li><a href="../RGen/ECore/ETypedElement.html">RGen::ECore::ETypedElement</a></li>
        
          <li><a href="../RGen/ECore/ETypedElement/ClassModule.html">RGen::ECore::ETypedElement::ClassModule</a></li>
        
          <li><a href="../RGen/ECore/RubyToECore.html">RGen::ECore::RubyToECore</a></li>
        
          <li><a href="../RGen/Environment.html">RGen::Environment</a></li>
        
          <li><a href="../RGen/Fragment.html">RGen::Fragment</a></li>
        
          <li><a href="../RGen/Fragment/DumpFileCache.html">RGen::Fragment::DumpFileCache</a></li>
        
          <li><a href="../RGen/Fragment/FragmentedModel.html">RGen::Fragment::FragmentedModel</a></li>
        
          <li><a href="../RGen/Fragment/ModelFragment.html">RGen::Fragment::ModelFragment</a></li>
        
          <li><a href="../RGen/Fragment/ModelFragment/FragmentRef.html">RGen::Fragment::ModelFragment::FragmentRef</a></li>
        
          <li><a href="../RGen/Fragment/ModelFragment/ResolvedReference.html">RGen::Fragment::ModelFragment::ResolvedReference</a></li>
        
          <li><a href="../RGen/Instantiator.html">RGen::Instantiator</a></li>
        
          <li><a href="../RGen/Instantiator/AbstractInstantiator.html">RGen::Instantiator::AbstractInstantiator</a></li>
        
          <li><a href="../RGen/Instantiator/DefaultXMLInstantiator.html">RGen::Instantiator::DefaultXMLInstantiator</a></li>
        
          <li><a href="../RGen/Instantiator/JsonInstantiator.html">RGen::Instantiator::JsonInstantiator</a></li>
        
          <li><a href="../RGen/Instantiator/JsonParser.html">RGen::Instantiator::JsonParser</a></li>
        
          <li><a href="../RGen/Instantiator/NodebasedXMLInstantiator.html">RGen::Instantiator::NodebasedXMLInstantiator</a></li>
        
          <li><a href="../RGen/Instantiator/NodebasedXMLInstantiator/Visitor.html">RGen::Instantiator::NodebasedXMLInstantiator::Visitor</a></li>
        
          <li><a href="../RGen/Instantiator/NodebasedXMLInstantiator/XMLNodeDescriptor.html">RGen::Instantiator::NodebasedXMLInstantiator::XMLNodeDescriptor</a></li>
        
          <li><a href="../RGen/Instantiator/QualifiedNameResolver.html">RGen::Instantiator::QualifiedNameResolver</a></li>
        
          <li><a href="../RGen/Instantiator/ReferenceResolver.html">RGen::Instantiator::ReferenceResolver</a></li>
        
          <li><a href="../RGen/Instantiator/ReferenceResolver/UnresolvedReference.html">RGen::Instantiator::ReferenceResolver::UnresolvedReference</a></li>
        
          <li><a href="../RGen/MetamodelBuilder.html">RGen::MetamodelBuilder</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/BuilderExtensions.html">RGen::MetamodelBuilder::BuilderExtensions</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/BuilderExtensions/FeatureBlockEvaluator.html">RGen::MetamodelBuilder::BuilderExtensions::FeatureBlockEvaluator</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/BuilderRuntime.html">RGen::MetamodelBuilder::BuilderRuntime</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/DataTypes.html">RGen::MetamodelBuilder::DataTypes</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/DataTypes/Enum.html">RGen::MetamodelBuilder::DataTypes::Enum</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/Intermediate.html">RGen::MetamodelBuilder::Intermediate</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/Intermediate/Annotation.html">RGen::MetamodelBuilder::Intermediate::Annotation</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/Intermediate/Attribute.html">RGen::MetamodelBuilder::Intermediate::Attribute</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/Intermediate/Feature.html">RGen::MetamodelBuilder::Intermediate::Feature</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/Intermediate/Reference.html">RGen::MetamodelBuilder::Intermediate::Reference</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/MMBase.html">RGen::MetamodelBuilder::MMBase</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/MMGeneric.html">RGen::MetamodelBuilder::MMGeneric</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/MMProxy.html">RGen::MetamodelBuilder::MMProxy</a></li>
        
          <li><a href="../RGen/MetamodelBuilder/ModuleExtension.html">RGen::MetamodelBuilder::ModuleExtension</a></li>
        
          <li><a href="../RGen/ModelBuilder.html">RGen::ModelBuilder</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext.html">RGen::ModelBuilder::BuilderContext</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext/CommandResolver.html">RGen::ModelBuilder::BuilderContext::CommandResolver</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext/ConstPathElement.html">RGen::ModelBuilder::BuilderContext::ConstPathElement</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext/ExtensionContainerFactory.html">RGen::ModelBuilder::BuilderContext::ExtensionContainerFactory</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext/ExtensionContainerFactory/ExtensionContainer.html">RGen::ModelBuilder::BuilderContext::ExtensionContainerFactory::ExtensionContainer</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext/PackageNotFoundException.html">RGen::ModelBuilder::BuilderContext::PackageNotFoundException</a></li>
        
          <li><a href="../RGen/ModelBuilder/BuilderContext/PackageResolver.html">RGen::ModelBuilder::BuilderContext::PackageResolver</a></li>
        
          <li><a href="../RGen/ModelBuilder/ModelSerializer.html">RGen::ModelBuilder::ModelSerializer</a></li>
        
          <li><a href="../RGen/ModelBuilder/ReferenceResolver.html">RGen::ModelBuilder::ReferenceResolver</a></li>
        
          <li><a href="../RGen/ModelBuilder/ReferenceResolver/ResolverException.html">RGen::ModelBuilder::ReferenceResolver::ResolverException</a></li>
        
          <li><a href="../RGen/ModelBuilder/ReferenceResolver/ToplevelNamespace.html">RGen::ModelBuilder::ReferenceResolver::ToplevelNamespace</a></li>
        
          <li><a href="../RGen/Serializer.html">RGen::Serializer</a></li>
        
          <li><a href="../RGen/Serializer/JsonSerializer.html">RGen::Serializer::JsonSerializer</a></li>
        
          <li><a href="../RGen/Serializer/QualifiedNameProvider.html">RGen::Serializer::QualifiedNameProvider</a></li>
        
          <li><a href="../RGen/Serializer/XMI11Serializer.html">RGen::Serializer::XMI11Serializer</a></li>
        
          <li><a href="../RGen/Serializer/XMI20Serializer.html">RGen::Serializer::XMI20Serializer</a></li>
        
          <li><a href="../RGen/Serializer/XMLSerializer.html">RGen::Serializer::XMLSerializer</a></li>
        
          <li><a href="../RGen/TemplateLanguage.html">RGen::TemplateLanguage</a></li>
        
          <li><a href="../RGen/TemplateLanguage/DirectoryTemplateContainer.html">RGen::TemplateLanguage::DirectoryTemplateContainer</a></li>
        
          <li><a href="../RGen/TemplateLanguage/OutputHandler.html">RGen::TemplateLanguage::OutputHandler</a></li>
        
          <li><a href="../RGen/TemplateLanguage/TemplateContainer.html">RGen::TemplateLanguage::TemplateContainer</a></li>
        
          <li><a href="../RGen/TemplateLanguage/TemplateHelper.html">RGen::TemplateLanguage::TemplateHelper</a></li>
        
          <li><a href="../RGen/Transformer.html">RGen::Transformer</a></li>
        
          <li><a href="../RGen/Util.html">RGen::Util</a></li>
        
          <li><a href="../RGen/Util/AutoClassCreator.html">RGen::Util::AutoClassCreator</a></li>
        
          <li><a href="../RGen/Util/AutoCreatedClass.html">RGen::Util::AutoCreatedClass</a></li>
        
          <li><a href="../RGen/Util/Base.html">RGen::Util::Base</a></li>
        
          <li><a href="../RGen/Util/CachedGlob.html">RGen::Util::CachedGlob</a></li>
        
          <li><a href="../RGen/Util/FileCacheMap.html">RGen::Util::FileCacheMap</a></li>
        
          <li><a href="../RGen/Util/FileChangeDetector.html">RGen::Util::FileChangeDetector</a></li>
        
          <li><a href="../RGen/Util/MethodDelegation.html">RGen::Util::MethodDelegation</a></li>
        
          <li><a href="../RGen/Util/ModelComparator.html">RGen::Util::ModelComparator</a></li>
        
          <li><a href="../RGen/Util/ModelComparatorBase.html">RGen::Util::ModelComparatorBase</a></li>
        
          <li><a href="../RGen/Util/ModelDumper.html">RGen::Util::ModelDumper</a></li>
        
          <li><a href="../RGen/Util/NameHelper.html">RGen::Util::NameHelper</a></li>
        
          <li><a href="../RGen/Util/ParentAccess.html">RGen::Util::ParentAccess</a></li>
        
          <li><a href="../RGen/Util/PatternMatcher.html">RGen::Util::PatternMatcher</a></li>
        
          <li><a href="../RGen/Util/PatternMatcher/Bindable.html">RGen::Util::PatternMatcher::Bindable</a></li>
        
          <li><a href="../RGen/Util/PatternMatcher/Lazy.html">RGen::Util::PatternMatcher::Lazy</a></li>
        
          <li><a href="../RGen/Util/PatternMatcher/Proxy.html">RGen::Util::PatternMatcher::Proxy</a></li>
        
          <li><a href="../RGen/Util/PatternMatcher/TempEnv.html">RGen::Util::PatternMatcher::TempEnv</a></li>
        
          <li><a href="../AbstractXMLInstantiator.html">AbstractXMLInstantiator</a></li>
        
          <li><a href="../AbstractXMLInstantiator/Visitor.html">AbstractXMLInstantiator::Visitor</a></li>
        
          <li><a href="../MMGen.html">MMGen</a></li>
        
          <li><a href="../MMGen/MetamodelGenerator.html">MMGen::MetamodelGenerator</a></li>
        
          <li><a href="../Array.html">Array</a></li>
        
          <li><a href="../EASupport.html">EASupport</a></li>
        
          <li><a href="../ECoreToUML13.html">ECoreToUML13</a></li>
        
          <li><a href="../ECoreXMLInstantiator.html">ECoreXMLInstantiator</a></li>
        
          <li><a href="../IdStore.html">IdStore</a></li>
        
          <li><a href="../Object.html">Object</a></li>
        
          <li><a href="../UML13ToECore.html">UML13ToECore</a></li>
        
          <li><a href="../XMI11Instantiator.html">XMI11Instantiator</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="module">RGen::TemplateLanguage</h1>

    <div id="description" class="description">
      
<p>The <a href="../RGen.html">RGen</a> template language has been designed to
build complex generators. It is very similar to the EXPAND language of the
Java based OpenArchitectureWare framework.</p>

<h1>Templates</h1>

<p>The basic idea is to allow "templates" not only being template files but
smaller parts. Those parts can be expanded from other parts very  much like
Ruby methods are called from other methods. Thus the term "template" refers
to such a part within a "template file".</p>

<p>Template files used by the <a href="../RGen.html">RGen</a> template
language should have a  filename with the postfix ".tpl". Those files can
reside within (nested) template file directories.</p>

<p>As an example a template directory could look like the following:</p>

<pre>templates/root.tpl
templates/dbaccess/dbaccess.tpl
templates/dbaccess/schema.tpl
templates/headers/generic_headers.tpl
templates/headers/specific/component.tpl</pre>

<p>A template is always called for a <em>context object</em>. The context
object serves as the receiver of methods called within the template.
Details are given below.</p>

<h1>Defining Templates</h1>

<p>One or more templates can be defined in a template file using the
<tt>define</tt> keyword as in the following example:</p>

<pre>&lt;% define 'GenerateDBAdapter', :for =&gt; DBDescription do |dbtype| %&gt;
  Content to be generated; use ERB syntax here
&lt;% end %&gt;</pre>

<p>The template definition takes three kinds of parameters:</p>
<ol><li>
<p>The name of the template within the template file as a String or Symbol</p>
</li><li>
<p>An optional class object describing the class of context objects for which
this template is valid.</p>
</li><li>
<p>An arbitrary number of template parameters</p>
</li></ol>

<p>See <a
href="TemplateLanguage/TemplateContainer.html">RGen::TemplateLanguage::TemplateContainer</a>
for details about the syntax of <tt>define</tt>.</p>

<p>Within a template, regular ERB syntax can be used. This is</p>
<ul><li>
<p><tt>&lt;%</tt> and <tt>%&gt;</tt> are used to embed Ruby code</p>
</li><li>
<p><tt>&lt;%=</tt> and <tt>%&gt;</tt> are used to embed Ruby expressions with
the expression result being written to the template output</p>
</li><li>
<p><tt>&lt;%#</tt> and <tt>%&gt;</tt> are used for comments</p>
</li></ul>

<p>All content not within these tags is written to the template output
verbatim. See below for details about output files and output formatting.</p>

<p>All methods which are called from within the template are sent to the
context object.</p>

<p>Experience shows that one easily forgets the <tt>do</tt> at the end of the
first  line of a template definition. This will result in an ERB parse
error.</p>

<h1>Expanding Templates</h1>

<p>Templates are normally expanded from within other templates. The only
exception is the root template, which is expanded from the surrounding
code.</p>

<p>Template names can be specified in the following ways:</p>
<ul><li>
<p>Non qualified name: use the template with the given name in the current
template file</p>
</li><li>
<p>Relative qualified name: use the template within the template file
specified by the relative path</p>
</li><li>
<p>Absolute qualified name: use the template within the template file
specified by the absolute path</p>
</li></ul>

<p>The <tt>expand</tt> keyword is used to expand templates.</p>

<p>Here are some examples:</p>

<pre>&lt;% expand 'GenerateDBAdapter', dbtype, :for =&gt; dbDesc %&gt;</pre>

<p><em>Non qualified</em>. Must be called within the file where
'GenerateDBAdapter' is defined. There is one template parameter passed in
via variable <tt>dbtype</tt>. The context object is provided in variable
<tt>dbDesc</tt>.</p>

<pre>&lt;% expand 'dbaccess::ExampleSQL' %&gt;</pre>

<p><em>Qualified with filename</em>. Must be called from a file in the same
directory as 'dbaccess.tpl' There are no parameters. The current context
object will be used as the context  object for this template expansion.</p>

<pre>&lt;% expand '../headers/generic_headers::CHeader', :foreach =&gt; modules %&gt;</pre>

<p><em>Relatively qualified</em>. Must be called from a location from which
the file 'generic_headers.tpl' is accessible via the relative path
'../headers'. The template is expanded for each module in <tt>modules</tt>
(which has to be an <a href="../Array.html">Array</a>). Each element of
<tt>modules</tt> will be the context object in turn.</p>

<pre>&lt;% expand '/headers/generic_headers::CHeader', :foreach =&gt; modules %&gt;</pre>

<p>Absolutely qualified: The same behaviour as before but with an absolute
path from the template directory root (which in this example is
'templates', see above)</p>

<p>Sometimes it is neccessary to generate some text (e.g. a ',') in between
the single template expansion results from a <tt>:foreach</tt> expansion.
This can be achieved by using the <tt>:separator</tt> keyword:</p>

<pre>&lt;% expand 'ColumnName', :foreach =&gt; column, :separator =&gt; ', ' %&gt;</pre>

<p>Note that the separator may also contain newline characters (n). See below
for details about formatting.</p>

<h1>Formatting</h1>

<p>For many generator tools a formatting postprocess (e.g. using a pretty
printer) is  required in order to make the output readable. However,
depending on the kind of generated output, such a tool might not be
available.</p>

<p>The <a href="../RGen.html">RGen</a> template language has been design for
generators which do not need a postprocessing step. The basic idea is to
eliminate all whitespace at the beginning of template lines (the
indentation that makes the <em>template</em> readable) and output newlines
only after at least on character has been generated in the corresponding
line. This way there are no empty lines in the output and each line will
start with a non-whitspace character.</p>

<p>Starting from this point one can add indentation and newlines as required
by using explicit formatting commands:</p>
<ul><li>
<p><tt>&lt;%nl%&gt;</tt> (newline) starts a new line</p>
</li><li>
<p><tt>&lt;%iinc%&gt;</tt> (indentation increment) increases the current
indentation</p>
</li><li>
<p><tt>&lt;%idec%&gt;</tt> (indentation decrement) decreases the current
indentation</p>
</li><li>
<p><tt>&lt;%nonl%&gt;</tt> (no newline) ignore next newline</p>
</li><li>
<p><tt>&lt;%nows%&gt;</tt> (no whitespace) ignore next whitespace</p>
</li></ul>

<p>Indentation takes place for every new line in the output unless it is 0.
The initial indentation can be specified with a root <tt>expand</tt>
command by using the <tt>:indent</tt> keyword.</p>

<p>Here is an example:</p>

<pre>expand 'GenerateDBAdapter', dbtype, :for =&gt; dbDesc, :indent =&gt; 1</pre>

<p>Initial indentation defaults to 0. Normally <tt>&lt;%iinc%&gt;</tt> and 
<tt>&lt;%idec%&gt;</tt> are used to change the indentation. The current
indentation is kept for expansion of subtemplates.</p>

<p>The string which is used to realize one indentation step can be set using
<a
href="TemplateLanguage/DirectoryTemplateContainer.html#method-i-indentString">DirectoryTemplateContainer#indentString</a>
or with the template language <tt>file</tt> command. The default is "   "
(3 spaces), the indentation string given at a <tt>file</tt> command
overwrites the container's default which in turn overwrites the overall
default.</p>

<p>Note that commands to ignore whitespace and newlines are still useful if
output  generated from multiple template lines should show up in one single
output line.</p>

<p>Here is an example of a template generating a C program:</p>

<pre>#include &lt;stdio.h&gt;
&lt;%nl%&gt;
int main() {&lt;%iinc%&gt;
  printf(&quot;Hello World\n&quot;);
  return 0;&lt;%idec&gt;
}</pre>

<p>The result is:</p>

<pre>#include &lt;stdio.h&gt;

int main() {
   printf(&quot;Hello World\n&quot;);
   return 0;
}</pre>

<p>Note that without the explicit formatting commands, the output generated
from the  example above would not have any empty lines or whitespace in the
beginning of lines. This may seem like unneccessary extra work for the
example above which could also have been generated by passing the template
to the output verbatimly. However in most cases templates will contain more
template specific indentation and newlines which should be eliminated than
formatting that should be visible in the  output.</p>

<p>Here is a more realistic example for generating C function prototypes:</p>

<pre>&lt;% define 'Prototype', :for =&gt; CFunction do %&gt;
  &lt;%= getType.name %&gt; &lt;%= name %&gt;(&lt;%nows%&gt;
    &lt;% expand 'Signature', :foreach =&gt; argument, :separator =&gt; ', ' %&gt;);
&lt;% end %&gt;

&lt;% define 'Signature', :for =&gt; CFunctionArgument do %&gt;
  &lt;%= getType.name %&gt; &lt;%= name%&gt;&lt;%nows%&gt;
&lt;% end %&gt;</pre>

<p>The result could look something like:</p>

<pre>void somefunc(int a, float b, int c);
int otherfunc(short x);</pre>

<p>In this example a separator is used to join the single arguments of the C
functions. Note that the template generating the argument type and name
needs to contain a <tt>&lt;%nows%&gt;</tt> if the result should consist of
a single line.</p>

<p>Here is one more example for generating C array initializations:</p>

<pre>&lt;% define 'Array', :for =&gt; CArray do %&gt;
  &lt;%= getType.name %&gt; &lt;%= name %&gt;[&lt;%= size %&gt;] = {&lt;%iinc%&gt;
    &lt;% expand 'InitValue', :foreach =&gt; initvalue, :separator =&gt; &quot;,\n&quot; %&gt;&lt;%nl%&gt;&lt;%idec%&gt;
  };
&lt;% end %&gt;

&lt;% define 'InitValue', :for =&gt; PrimitiveInitValue do %&gt;
  &lt;%= value %&gt;&lt;%nows%&gt;
&lt;% end %&gt;</pre>

<p>The result could look something like:</p>

<pre>int myArray[3] = {
   1,
   2,
   3
};</pre>

<p>Note that in this example, the separator contains a newline. The current
increment will be applied to each single expansion result since it starts
in a new line.</p>

<h1>Output Files</h1>

<p>Normally the generated content is to be written into one or more output
files. The <a href="../RGen.html">RGen</a> template language facilitates
this by means of the <tt>file</tt> keyword.</p>

<p>When the <tt>file</tt> keyword is used to define a block, all output
generated from template code within this block will be written to the
specified file. This includes output generated from template expansions.
Thus all output from templates expanded within this block is written to the
same file as long as those templates do not use the <tt>file</tt> keyword
to  define a new file context.</p>

<p>Here is an example:</p>

<pre>&lt;% file 'dbadapter/'+adapter.name+'.c' do %&gt;
  all content within this block will be written to the specified file
&lt;% end %&gt;</pre>

<p>Note that the filename itself can be calculated dynamically by an arbitrary
Ruby expression.</p>

<p>The absolute position where the output file is created depends on the
output root directory passed to <a
href="TemplateLanguage/DirectoryTemplateContainer.html">DirectoryTemplateContainer</a>
as described below.</p>

<p>As a second argument, the <tt>file</tt> command can take the indentation
string which is used to indent output lines (see Formatting).</p>

<h1>Setting up the Generator</h1>

<p>Setting up the generator consists of 3 steps:</p>
<ul><li>
<p>Instantiate <a
href="TemplateLanguage/DirectoryTemplateContainer.html">DirectoryTemplateContainer</a>
passing one or more metamodel(s) and the output  directory to the
constructor.</p>
</li><li>
<p>Load the templates into the template container</p>
</li><li>
<p>Expand the root template to start generation</p>
</li></ul>

<p>Here is an example:</p>

<pre>module MyMM
  # metaclasses are defined here, e.g. using RGen::MetamodelBuilder
end

OUTPUT_DIR = File.dirname(__FILE__)+&quot;/output&quot;
TEMPLATES_DIR = File.dirname(__FILE__)+&quot;/templates&quot;

tc = RGen::TemplateLanguage::DirectoryTemplateContainer.new(MyMM, OUTPUT_DIR)
tc.load(TEMPLATES_DIR)
# testModel should hold an instance of the metamodel class expected by the root template
# the following line starts generation
tc.expand('root::Root', :for =&gt; testModel, :indent =&gt; 1)</pre>

<p>The metamodel is the Ruby module which contains the metaclasses. This
information is required for the template container in order to resolve the
metamodel classes used within the template file.  If several metamodels
shall be used, an array of modules can be passed instead of a single
module.</p>

<p>The output path is prepended to the relative paths provided to the
<tt>file</tt>  definitions in the template files.</p>

<p>The template directory should contain template files as described above.</p>

<p>Finally the generation process is started by calling <tt>expand</tt> in the
same way as it is used from within templates.</p>

<p>Also see the unit tests for more examples.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

