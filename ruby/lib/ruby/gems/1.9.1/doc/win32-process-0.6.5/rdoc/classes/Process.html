<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Process</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Process</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/win32/process_rb.html">
                lib/win32/process.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000011">create</a>&nbsp;&nbsp;
      <a href="#M000015">fork</a>&nbsp;&nbsp;
      <a href="#M000001">get_affinity</a>&nbsp;&nbsp;
      <a href="#M000005">getpriority</a>&nbsp;&nbsp;
      <a href="#M000003">getrlimit</a>&nbsp;&nbsp;
      <a href="#M000002">job?</a>&nbsp;&nbsp;
      <a href="#M000010">kill</a>&nbsp;&nbsp;
      <a href="#M000014">ppid</a>&nbsp;&nbsp;
      <a href="#M000006">setpriority</a>&nbsp;&nbsp;
      <a href="#M000004">setrlimit</a>&nbsp;&nbsp;
      <a href="#M000007">uid</a>&nbsp;&nbsp;
      <a href="#M000012">wait</a>&nbsp;&nbsp;
      <a href="#M000013">wait2</a>&nbsp;&nbsp;
      <a href="#M000008">waitpid</a>&nbsp;&nbsp;
      <a href="#M000009">waitpid2</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">Windows::Process</span>
        <span class="include-name">Windows::Thread</span>
        <span class="include-name">Windows::Error</span>
        <span class="include-name">Windows::Library</span>
        <span class="include-name">Windows::Console</span>
        <span class="include-name">Windows::Handle</span>
        <span class="include-name">Windows::Security</span>
        <span class="include-name">Windows::Synchronize</span>
        <span class="include-name">Windows::Window</span>
        <span class="include-name">Windows::Unicode</span>
        <span class="include-name">Windows::ToolHelper</span>
        <span class="include-name">Windows::MSVCRT::String</span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="Process/Error.html" class="link">Process::Error</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">WIN32_PROCESS_VERSION</td>
          <td>=</td>
          <td class="context-item-value">'0.6.5'</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The version of the win32-process library

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PRIO_PROCESS</td>
          <td>=</td>
          <td class="context-item-value">0</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Defined for interface compatibility, but not used

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PRIO_PGRP</td>
          <td>=</td>
          <td class="context-item-value">1</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PRIO_USER</td>
          <td>=</td>
          <td class="context-item-value">2</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="Process.src/M000011.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000011.html');return false;">
          <span class="method-name">create</span><span class="method-args">(args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="Process.html#M000011">Process.create</a>(key =&gt; value, &#8230;)
=&gt; ProcessInfo
</p>
<p>
This is a wrapper for the CreateProcess() function. It executes a process,
returning a ProcessInfo struct. It accepts a hash as an argument. There are
several primary keys:
</p>
<ul>
<li>command_line (mandatory)

</li>
<li>app_name (default: nil)

</li>
<li>inherit (default: false)

</li>
<li>process_inherit (default: false)

</li>
<li>thread_inherit (default: false)

</li>
<li>creation_flags (default: 0)

</li>
<li>cwd (default: Dir.pwd)

</li>
<li>startup_info (default: nil)

</li>
<li>environment (default: nil)

</li>
<li>close_handles (default: true)

</li>
<li>with_logon (default: nil)

</li>
<li>domain (default: nil)

</li>
<li>password (default: nil)

</li>
</ul>
<p>
Of these, the &#8216;command_line&#8217; or &#8216;app_name&#8217; must be
specified or an error is raised. Both may be set individually, but
&#8216;command_line&#8217; should be preferred if only one of them is set
because it does not (necessarily) require an explicit path or extension to
work.
</p>
<p>
The &#8216;domain&#8217; and &#8216;password&#8217; options are only
relevent in the context of &#8216;with_logon&#8217;.
</p>
<p>
The startup_info key takes a hash. Its keys are attributes that are part of
the StartupInfo struct, and are generally only meaningful for GUI or
console processes. See the documentation on CreateProcess() and the
StartupInfo struct on MSDN for more information.
</p>
<ul>
<li>desktop

</li>
<li>title

</li>
<li>x

</li>
<li>y

</li>
<li>x_size

</li>
<li>y_size

</li>
<li>x_count_chars

</li>
<li>y_count_chars

</li>
<li>fill_attribute

</li>
<li>sw_flags

</li>
<li>startf_flags

</li>
<li>stdin

</li>
<li>stdout

</li>
<li>stderr

</li>
</ul>
<p>
The relevant constants for &#8216;creation_flags&#8217;,
&#8216;sw_flags&#8217; and &#8216;startf_flags&#8217; are included in the
Windows::Process, Windows::Console and Windows::Window modules. These come
with the windows-pr library, a prerequisite of this library. Note that the
&#8216;stdin&#8217;, &#8216;stdout&#8217; and &#8216;stderr&#8217; options
can be either Ruby IO objects or file descriptors (i.e. a fileno). However,
StringIO objects are not currently supported.
</p>
<p>
If &#8216;stdin&#8217;, &#8216;stdout&#8217; or &#8216;stderr&#8217; are
specified, then the <tt>inherit</tt> value is automatically set to true and
the Process::STARTF_USESTDHANDLES flag is automatically OR&#8216;d to the
<tt>startf_flags</tt> value.
</p>
<p>
The ProcessInfo struct contains the following members:
</p>
<ul>
<li>process_handle - The handle to the newly created process.

</li>
<li>thread_handle - The handle to the primary thread of the process.

</li>
<li>process_id - <a href="Process.html">Process</a> ID.

</li>
<li>thread_id - Thread ID.

</li>
</ul>
<p>
If the &#8216;close_handles&#8217; option is set to true (the default) then
the process_handle and the thread_handle are automatically closed for you
before the ProcessInfo struct is returned.
</p>
<p>
If the &#8216;with_logon&#8217; option is set, then the process runs the
specified executable file in the security context of the specified
credentials.
</p>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="Process.src/M000015.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000015.html');return false;">
          <span class="method-name">fork</span><span class="method-args">() {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates the equivalent of a subshell via the CreateProcess() function. This
behaves in a manner that is similar, but not identical to, the <a
href="Kernel.html#M000016">Kernel.fork</a> method for Unix. Unlike the Unix
<a href="Process.html#M000015">fork</a>, this method starts from the top of
the script rather than the point of the call.
</p>
<p>
WARNING: This implementation should be considered experimental. It is not
recommended for production use.
</p>
        </div>
      </div>

      <div id="method-M000001" class="method-detail">
        <a name="M000001"></a>

        <div class="method-heading">
          <a href="Process.src/M000001.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000001.html');return false;">
          <span class="method-name">get_affinity</span><span class="method-args">(int = Process.pid)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the process and system affinity mask for the given <tt>pid</tt>, or
the current process if no pid is provided. The return value is a two
element array, with the first containing the process affinity mask, and the
second containing the system affinity mask. Both are decimal values.
</p>
<p>
A process affinity mask is a bit vector indicating the processors that a
process is allowed to run on. A system affinity mask is a bit vector in
which each bit represents the processors that are configured into a system.
</p>
<p>
Example:
</p>
<pre>
   # System has 4 processors, current process is allowed to run on all
   Process.get_affinity # =&gt; [[15], [15]]

   # System has 4 processors, current process only allowed on 1 and 4 only
   Process.get_affinity # =&gt; [[9], [15]]
</pre>
<p>
If you want to convert a decimal bit vector into an array of 0&#8216;s and
1&#8216;s indicating the flag value of each processor, you can use
something like this approach:
</p>
<pre>
   mask = Process.get_affinity.first
   (0..mask).to_a.map{ |n| mask[n] }
</pre>
        </div>
      </div>

      <div id="method-M000005" class="method-detail">
        <a name="M000005"></a>

        <div class="method-heading">
          <a href="Process.src/M000005.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000005.html');return false;">
          <span class="method-name">getpriority</span><span class="method-args">(kind, int)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Retrieves the priority class for the specified process id <tt>int</tt>.
Unlike the default implementation, lower return values do not necessarily
correspond to higher priority classes.
</p>
<p>
The <tt>kind</tt> parameter is ignored but required for API compatibility.
You can only retrieve process information, not process group or user
information, so it is effectively always Process::PRIO_PROCESS.
</p>
<p>
Possible return values are:
</p>
<p>
32 - Process::NORMAL_PRIORITY_CLASS 64 - Process::IDLE_PRIORITY_CLASS 128 -
Process::HIGH_PRIORITY_CLASS 256 - Process::REALTIME_PRIORITY_CLASS 16384 -
Process::BELOW_NORMAL_PRIORITY_CLASS 32768 -
Process::ABOVE_NORMAL_PRIORITY_CLASS
</p>
        </div>
      </div>

      <div id="method-M000003" class="method-detail">
        <a name="M000003"></a>

        <div class="method-heading">
          <a href="Process.src/M000003.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000003.html');return false;">
          <span class="method-name">getrlimit</span><span class="method-args">(resource)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the resource limit of the current process. Only a limited number of
flags are supported.
</p>
<p>
Process::RLIMIT_CPU Process::RLIMIT_FSIZE Process::RLIMIT_AS
Process::RLIMIT_RSS Process::RLIMIT_VMEM
</p>
<p>
The <a href="Process.html">Process</a>:RLIMIT_AS, Process::RLIMIT_RSS and
Process::VMEM constants all refer to the <a href="Process.html">Process</a>
memory limit. The Process::RLIMIT_CPU constant refers to the per process
user time limit. The Process::RLIMIT_FSIZE constant is hard coded to the
maximum file size on an NTFS filesystem, approximately 4TB (or 4GB if not
NTFS).
</p>
<p>
While a two element array is returned in order to comply with the spec,
there is no separate hard and soft limit. The values will always be the
same.
</p>
<p>
If [0,0] is returned then it means no limit has been set.
</p>
<p>
Example:
</p>
<pre>
  Process.getrlimit(Process::RLIMIT_VMEM) # =&gt; [0, 0]
</pre>
        </div>
      </div>

      <div id="method-M000002" class="method-detail">
        <a name="M000002"></a>

        <div class="method-heading">
          <a href="Process.src/M000002.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000002.html');return false;">
          <span class="method-name">job?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the current process is part of a Job.
</p>
        </div>
      </div>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="Process.src/M000010.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000010.html');return false;">
          <span class="method-name">kill</span><span class="method-args">(signal, *pids)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sends the given <tt>signal</tt> to an array of process id&#8216;s. The
<tt>signal</tt> may be any value from 0 to 9, or the special strings
&#8216;SIGINT&#8217; (or &#8216;INT&#8217;), &#8216;SIGBRK&#8217; (or
&#8216;BRK&#8217;) and &#8216;SIGKILL&#8217; (or &#8216;KILL&#8217;). An
array of successfully killed pids is returned.
</p>
<p>
Signal 0 merely tests if the process is running without killing it. Signal
2 sends a CTRL_C_EVENT to the process. Signal 3 sends a CTRL_BRK_EVENT to
the process. Signal 9 kills the process in a harsh manner. Signals 1 and
4-8 <a href="Process.html#M000010">kill</a> the process in a nice manner.
</p>
<p>
SIGINT/INT corresponds to signal 2 SIGBRK/BRK corresponds to signal 3
SIGKILL/KILL corresponds to signal 9
</p>
<p>
Signals 2 and 3 only affect console processes, and then only if the process
was created with the CREATE_NEW_PROCESS_GROUP flag.
</p>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="Process.src/M000014.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000014.html');return false;">
          <span class="method-name">ppid</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the process ID of the parent of this process.
</p>
        </div>
      </div>

      <div id="method-M000006" class="method-detail">
        <a name="M000006"></a>

        <div class="method-heading">
          <a href="Process.src/M000006.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000006.html');return false;">
          <span class="method-name">setpriority</span><span class="method-args">(kind, int, int_priority)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the priority class for the specified process id <tt>int</tt>.
</p>
<p>
The <tt>kind</tt> parameter is ignored but present for API compatibility.
You can only retrieve process information, not process group or user
information, so it is effectively always Process::PRIO_PROCESS.
</p>
<p>
Possible <tt>int_priority</tt> values are:
</p>
<ul>
<li>Process::NORMAL_PRIORITY_CLASS

</li>
<li>Process::IDLE_PRIORITY_CLASS

</li>
<li>Process::HIGH_PRIORITY_CLASS

</li>
<li>Process::REALTIME_PRIORITY_CLASS

</li>
<li>Process::BELOW_NORMAL_PRIORITY_CLASS

</li>
<li>Process::ABOVE_NORMAL_PRIORITY_CLASS

</li>
</ul>
        </div>
      </div>

      <div id="method-M000004" class="method-detail">
        <a name="M000004"></a>

        <div class="method-heading">
          <a href="Process.src/M000004.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000004.html');return false;">
          <span class="method-name">setrlimit</span><span class="method-args">(resource, current_limit, max_limit = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the resource limit of the current process. Only a limited number of
flags are supported.
</p>
<p>
Process::RLIMIT_CPU Process::RLIMIT_AS Process::RLIMIT_RSS
Process::RLIMIT_VMEM
</p>
<p>
The <a href="Process.html">Process</a>:RLIMIT_AS, Process::RLIMIT_RSS and
Process::VMEM constants all refer to the <a href="Process.html">Process</a>
memory limit. The Process::RLIMIT_CPU constant refers to the per process
user time limit.
</p>
<p>
The <tt>max_limit</tt> parameter is provided for interface compatibility
only. It is always set to the current_limit value.
</p>
<p>
Example:
</p>
<pre>
  Process.setrlimit(Process::RLIMIT_VMEM, 1024 * 4) # =&gt; nil
  Process.getrlimit(Process::RLIMIT_VMEM) # =&gt; [4096, 4096]
</pre>
        </div>
      </div>

      <div id="method-M000007" class="method-detail">
        <a name="M000007"></a>

        <div class="method-heading">
          <a href="Process.src/M000007.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000007.html');return false;">
          <span class="method-name">uid</span><span class="method-args">(sid = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Process.html#M000007">uid</a> of the current process.
Specifically, it returns the RID of the SID associated with the owner of
the process.
</p>
<p>
If <tt>sid</tt> is set to true, then a binary sid is returned. Otherwise, a
numeric id is returned (the default).
</p>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="Process.src/M000012.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000012.html');return false;">
          <span class="method-name">wait</span><span class="method-args">(pid = -1, flags = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Waits for any child process to exit and returns the process id of that
child. If a pid is provided that is greater than or equal to 0, then it is
the equivalent of calling <a
href="Process.html#M000008">Process.waitpid</a>.
</p>
<p>
The <tt>flags</tt> argument is ignored at the moment. It is provided
strictly for interface compatibility.
</p>
<p>
Note that the $? (Process::Status) global variable is NOT set. This may be
addressed in a future release.
</p>
        </div>
      </div>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="Process.src/M000013.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000013.html');return false;">
          <span class="method-name">wait2</span><span class="method-args">(pid = -1, flags = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Waits for any child process to exit and returns an array containing the
process id and the exit status of that child.
</p>
<p>
The <tt>flags</tt> argument is ignored at the moment. It is provided
strictly for interface compatibility.
</p>
<p>
Note that the $? (Process::Status) global variable is NOT set. This may be
addressed in a future release.
</p>
        </div>
      </div>

      <div id="method-M000008" class="method-detail">
        <a name="M000008"></a>

        <div class="method-heading">
          <a href="Process.src/M000008.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000008.html');return false;">
          <span class="method-name">waitpid</span><span class="method-args">(pid, flags = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Waits for the given child process to exit and returns that pid.
</p>
<p>
The <tt>flags</tt> argument is ignored at the moment. It is provided
strictly for interface compatibility.
</p>
<p>
Note that the $? (Process::Status) global variable is NOT set. This may be
addressed in a future release.
</p>
        </div>
      </div>

      <div id="method-M000009" class="method-detail">
        <a name="M000009"></a>

        <div class="method-heading">
          <a href="Process.src/M000009.html" target="Code" class="method-signature"
            onclick="popupCode('Process.src/M000009.html');return false;">
          <span class="method-name">waitpid2</span><span class="method-args">(pid, flags = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Waits for the given child process to exit and returns an array containing
the process id and the exit status.
</p>
<p>
The <tt>flags</tt> argument is ignored at the moment. It is provided
strictly for interface compatibility.
</p>
<p>
Note that the $? (Process::Status) global variable is NOT set. This may be
addressed in a future release if/when possible.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>